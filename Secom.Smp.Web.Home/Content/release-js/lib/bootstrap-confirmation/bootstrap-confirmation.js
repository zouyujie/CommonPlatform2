/*!
 * Bootstrap Confirmation
 * Copyright 2013 Nimit Suwannagate <ethaizone@hotmail.com>
 * Copyright 2014-2016 Damien "Mistic" Sorel <http://www.strangeplanet.fr>
 * Licensed under the Apache License, Version 2.0 (the "License")
 */

(function(e){function n(e){var t=window,n=e.split("."),r=n.pop();for(var i=0,s=n.length;i<s;i++)t=t[n[i]];return function(){t[r].call(this)}}if(!e.fn.popover)throw new Error("Confirmation requires popover.js");var t=function(t,n){n.trigger="click",this.init("confirmation",t,n),this.options._isDelegate=!1,n.selector?this.options._selector=this._options._selector=n._root_selector+" "+n.selector:n._selector?(this.options._selector=n._selector,this.options._isDelegate=!0):this.options._selector=n._root_selector;var r=this;this.options.selector||(this.options._attributes={},this.options.copyAttributes?typeof this.options.copyAttributes=="string"&&(this.options.copyAttributes=this.options.copyAttributes.split(" ")):this.options.copyAttributes=[],this.options.copyAttributes.forEach(function(e){this.options._attributes[e]=this.$element.attr(e)},this),this.$element.on(r.options.trigger,function(e,t){t||(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation())}),this.$element.on("show.bs.confirmation",function(t){r.options.singleton&&e(r.options._selector).not(e(this)).filter(function(){return e(this).data("bs.confirmation")!==undefined}).confirmation("hide")})),this.options._isDelegate||(this.eventBody=!1,this.uid=this.$element[0].id||this.getUID("group_"),this.$element.on("shown.bs.confirmation",function(t){if(r.options.popout&&!r.eventBody){var n=e(this);r.eventBody=e("body").on("click.bs.confirmation."+r.uid,function(t){if(e(r.options._selector).is(t.target))return;e(r.options._selector).filter(function(){return e(this).data("bs.confirmation")!==undefined}).confirmation("hide"),e("body").off("click.bs."+r.uid),r.eventBody=!1})}}))};t.DEFAULTS=e.extend({},e.fn.popover.Constructor.DEFAULTS,{placement:"top",title:"Are you sure?",html:!0,popout:!1,singleton:!1,copyAttributes:"href target",onConfirm:e.noop,onCancel:e.noop,btnOkClass:"btn-xs btn-primary",btnOkIcon:"glyphicon glyphicon-ok",btnOkLabel:"Yes",btnCancelClass:"btn-xs btn-default",btnCancelIcon:"glyphicon glyphicon-remove",btnCancelLabel:"No",template:'<div class="popover confirmation"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content text-center"><div class="btn-group"><a class="btn" data-apply="confirmation"></a><a class="btn" data-dismiss="confirmation"></a></div></div></div>'}),t.prototype=e.extend({},e.fn.popover.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var t=this,n=this.tip(),r=this.options;n.find(".popover-title")[r.html?"html":"text"](this.getTitle()),n.find('[data-apply="confirmation"]').addClass(r.btnOkClass).html(r.btnOkLabel).attr(this.options._attributes).prepend(e("<i></i>").addClass(r.btnOkIcon)," ").off("click").one("click",function(e){t.getOnConfirm.call(t).call(t.$element),t.$element.trigger("confirmed.bs.confirmation"),t.$element.trigger(t.options.trigger,[!0]),t.$element.confirmation("hide")}),n.find('[data-dismiss="confirmation"]').addClass(r.btnCancelClass).html(r.btnCancelLabel).prepend(e("<i></i>").addClass(r.btnCancelIcon)," ").off("click").one("click",function(e){t.getOnCancel.call(t).call(t.$element),t.inState&&(t.inState.click=!1),t.$element.trigger("canceled.bs.confirmation"),t.$element.confirmation("hide")}),n.removeClass("fade top bottom left right in"),n.find(".popover-title").html()||n.find(".popover-title").hide()},t.prototype.getOnConfirm=function(){return this.$element.attr("data-on-confirm")?n(this.$element.attr("data-on-confirm")):this.options.onConfirm},t.prototype.getOnCancel=function(){return this.$element.attr("data-on-cancel")?n(this.$element.attr("data-on-cancel")):this.options.onCancel};var r=e.fn.confirmation;e.fn.confirmation=function(n){var r=typeof n=="object"&&n||{};return r._root_selector=this.selector,this.each(function(){var i=e(this),s=i.data("bs.confirmation");if(!s&&n=="destroy")return;s||i.data("bs.confirmation",s=new t(this,r)),typeof n=="string"&&(s[n](),n=="hide"&&s.inState&&(s.inState.click=!1))})},e.fn.confirmation.Constructor=t,e.fn.confirmation.noConflict=function(){return e.fn.confirmation=r,this}})(jQuery);