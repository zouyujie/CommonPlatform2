/*!
 * jQVMap Version 1.0
 *
 * http://jqvmap.com
 *
 * Copyright 2012, Peter Schmalfeldt <manifestinteractive@gmail.com>
 * Copyright 2011-2012, Kirill Lebedev
 * Licensed under the MIT license.
 *
 * Fork Me @ https://github.com/manifestinteractive/jqvmap
 */

(function(e){var t={colors:1,values:1,backgroundColor:1,scaleColors:1,normalizeFunction:1,enableZoom:1,showTooltip:1,borderColor:1,borderWidth:1,borderOpacity:1,selectedRegions:1,multiSelectRegion:1},n={onLabelShow:"labelShow",onRegionOver:"regionMouseOver",onRegionOut:"regionMouseOut",onRegionClick:"regionClick",onRegionSelect:"regionSelect",onRegionDeselect:"regionDeselect"};e.fn.vectorMap=function(r){var s={map:"world_en",backgroundColor:"#a5bfdd",color:"#f4f3f0",hoverColor:"#c9dfaf",selectedColor:"#c9dfaf",scaleColors:["#b6d6ff","#005ace"],normalizeFunction:"linear",enableZoom:!0,showTooltip:!0,borderColor:"#818181",borderWidth:1,borderOpacity:.25,selectedRegions:null,multiSelectRegion:!1},o=this.data("mapObject");if(r==="addMap")i.maps[arguments[1]]=arguments[2];else if(r==="set"&&t[arguments[1]])o["set"+arguments[1].charAt(0).toUpperCase()+arguments[1].substr(1)].apply(o,Array.prototype.slice.call(arguments,2));else{if(typeof r=="string"&&typeof o[r]=="function")return o[r].apply(o,Array.prototype.slice.call(arguments,1));e.extend(s,r),s.container=this,this.css({position:"relative",overflow:"hidden"}),o=new i(s),this.data("mapObject",o);for(var u in n)s[u]&&this.bind(n[u]+".jqvmap",s[u])}};var r=function(e,t,n){this.mode=window.SVGAngle?"svg":"vml",this.params=n;if(this.mode=="svg")this.createSvgNode=function(e){return document.createElementNS(this.svgns,e)};else{try{document.namespaces.rvml||document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),this.createVmlNode=function(e){return document.createElement("<rvml:"+e+' class="rvml">')}}catch(r){this.createVmlNode=function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)")}this.mode=="svg"?this.canvas=this.createSvgNode("svg"):(this.canvas=this.createVmlNode("group"),this.canvas.style.position="absolute"),this.setSize(e,t)};r.prototype={svgns:"http://www.w3.org/2000/svg",mode:"svg",width:0,height:0,canvas:null,setSize:function(e,t){if(this.mode=="svg")this.canvas.setAttribute("width",e),this.canvas.setAttribute("height",t);else{this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.coordsize=e+" "+t,this.canvas.coordorigin="0 0";if(this.rootGroup){var n=this.rootGroup.getElementsByTagName("shape");for(var r=0,i=n.length;r<i;r++)n[r].coordsize=e+" "+t,n[r].style.width=e+"px",n[r].style.height=t+"px";this.rootGroup.coordsize=e+" "+t,this.rootGroup.style.width=e+"px",this.rootGroup.style.height=t+"px"}}this.width=e,this.height=t},createPath:function(e){var t;if(this.mode=="svg")t=this.createSvgNode("path"),t.setAttribute("d",e.path),this.params.borderColor!==null&&t.setAttribute("stroke",this.params.borderColor),this.params.borderWidth>0&&(t.setAttribute("stroke-width",this.params.borderWidth),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-linejoin","round")),this.params.borderOpacity>0&&t.setAttribute("stroke-opacity",this.params.borderOpacity),t.setFill=function(e){this.setAttribute("fill",e),this.getAttribute("original")===null&&this.setAttribute("original",e)},t.getFill=function(e){return this.getAttribute("fill")},t.getOriginalFill=function(){return this.getAttribute("original")},t.setOpacity=function(e){this.setAttribute("fill-opacity",e)};else{t=this.createVmlNode("shape"),t.coordorigin="0 0",t.coordsize=this.width+" "+this.height,t.style.width=this.width+"px",t.style.height=this.height+"px",t.fillcolor=i.defaultFillColor,t.stroked=!1,t.path=r.pathSvgToVml(e.path);var n=this.createVmlNode("skew");n.on=!0,n.matrix="0.01,0,0,0.01,0,0",n.offset="0,0",t.appendChild(n);var s=this.createVmlNode("fill");t.appendChild(s),t.setFill=function(e){this.getElementsByTagName("fill")[0].color=e,this.getAttribute("original")===null&&this.setAttribute("original",e)},t.getFill=function(e){return this.getElementsByTagName("fill")[0].color},t.getOriginalFill=function(){return this.getAttribute("original")},t.setOpacity=function(e){this.getElementsByTagName("fill")[0].opacity=parseInt(e*100,10)+"%"}}return t},createGroup:function(e){var t;return this.mode=="svg"?t=this.createSvgNode("g"):(t=this.createVmlNode("group"),t.style.width=this.width+"px",t.style.height=this.height+"px",t.style.left="0px",t.style.top="0px",t.coordorigin="0 0",t.coordsize=this.width+" "+this.height),e&&(this.rootGroup=t),t},applyTransformParams:function(e,t,n){this.mode=="svg"?this.rootGroup.setAttribute("transform","scale("+e+") translate("+t+", "+n+")"):(this.rootGroup.coordorigin=this.width-t+","+(this.height-n),this.rootGroup.coordsize=this.width/e+","+this.height/e)}},r.pathSvgToVml=function(e){var t="",n=0,r=0,i,s;return e.replace(/([MmLlHhVvCcSs])((?:-?(?:\d+)?(?:\.\d+)?,?\s?)+)/g,function(e,t,o,u){o=o.replace(/(\d)-/g,"$1,-").replace(/\s+/g,",").split(","),o[0]||o.shift();for(var a=0,f=o.length;a<f;a++)o[a]=Math.round(100*o[a]);switch(t){case"m":return n+=o[0],r+=o[1],"t"+o.join(",");case"M":return n=o[0],r=o[1],"m"+o.join(",");case"l":return n+=o[0],r+=o[1],"r"+o.join(",");case"L":return n=o[0],r=o[1],"l"+o.join(",");case"h":return n+=o[0],"r"+o[0]+",0";case"H":return n=o[0],"l"+n+","+r;case"v":return r+=o[0],"r0,"+o[0];case"V":return r=o[0],"l"+n+","+r;case"c":return i=n+o[o.length-4],s=r+o[o.length-3],n+=o[o.length-2],r+=o[o.length-1],"v"+o.join(",");case"C":return i=o[o.length-4],s=o[o.length-3],n=o[o.length-2],r=o[o.length-1],"c"+o.join(",");case"s":return o.unshift(r-s),o.unshift(n-i),i=n+o[o.length-4],s=r+o[o.length-3],n+=o[o.length-2],r+=o[o.length-1],"v"+o.join(",");case"S":return o.unshift(r+r-s),o.unshift(n+n-i),i=o[o.length-4],s=o[o.length-3],n=o[o.length-2],r=o[o.length-1],"c"+o.join(",");default:return!1}return""}).replace(/z/g,"")};var i=function(t){t=t||{};var n=this,o=i.maps[t.map];this.selectedRegions=[],this.multiSelectRegion=t.multiSelectRegion,this.container=t.container,this.defaultWidth=o.width,this.defaultHeight=o.height,this.color=t.color,this.selectedColor=t.selectedColor,this.hoverColor=t.hoverColor,this.hoverOpacity=t.hoverOpacity,this.setBackgroundColor(t.backgroundColor),this.width=t.container.width(),this.height=t.container.height(),this.resize(),jQuery(window).resize(function(){n.width=t.container.width(),n.height=t.container.height(),n.resize(),n.canvas.setSize(n.width,n.height),n.applyTransform()}),this.canvas=new r(this.width,this.height,t),t.container.append(this.canvas.canvas),this.makeDraggable(),this.rootGroup=this.canvas.createGroup(!0),this.index=i.mapIndex,this.label=jQuery("<div/>").addClass("jqvmap-label").appendTo(jQuery("body")),t.enableZoom&&(jQuery("<div/>").addClass("jqvmap-zoomin").text("+").appendTo(t.container),jQuery("<div/>").addClass("jqvmap-zoomout").html("&#x2212;").appendTo(t.container)),n.countries=[];for(var u in o.pathes){var a=this.canvas.createPath({path:o.pathes[u].path});a.setFill(this.color),a.id=n.getCountryId(u),n.countries[u]=a,this.canvas.mode=="svg"?a.setAttribute("class","jvectormap-region"):jQuery(a).addClass("jvectormap-region"),jQuery(this.rootGroup).append(a)}jQuery(t.container).delegate(this.canvas.mode=="svg"?"path":"shape","mouseover mouseout",function(r){var i=r.target,s=r.target.id.split("_").pop(),u=e.Event("labelShow.jqvmap"),a=e.Event("regionMouseOver.jqvmap");r.type=="mouseover"?(jQuery(t.container).trigger(a,[s,o.pathes[s].name]),a.isDefaultPrevented()||n.highlight(s,i),t.showTooltip&&(n.label.text(o.pathes[s].name),jQuery(t.container).trigger(u,[n.label,s]),u.isDefaultPrevented()||(n.label.show(),n.labelWidth=n.label.width(),n.labelHeight=n.label.height()))):(n.unhighlight(s,i),n.label.hide(),jQuery(t.container).trigger("regionMouseOut.jqvmap",[s,o.pathes[s].name]))}),jQuery(t.container).delegate(this.canvas.mode=="svg"?"path":"shape","click",function(e){if(!t.multiSelectRegion)for(var r in o.pathes)n.countries[r].currentFillColor=n.countries[r].getOriginalFill(),n.countries[r].setFill(n.countries[r].getOriginalFill());var i=e.target,s=e.target.id.split("_").pop();jQuery(t.container).trigger("regionClick.jqvmap",[s,o.pathes[s].name]),n.selectedRegions.indexOf(s)!==-1?n.deselect(s,i):n.select(s,i)}),t.showTooltip&&t.container.mousemove(function(e){n.label.is(":visible")&&n.label.css({left:e.pageX-15-n.labelWidth,top:e.pageY-15-n.labelHeight})}),this.setColors(t.colors),this.canvas.canvas.appendChild(this.rootGroup),this.applyTransform(),this.colorScale=new s(t.scaleColors,t.normalizeFunction,t.valueMin,t.valueMax),t.values&&(this.values=t.values,this.setValues(t.values));if(t.selectedRegions)if(t.selectedRegions instanceof Array)for(var f in t.selectedRegions)this.select(t.selectedRegions[f].toLowerCase());else this.select(t.selectedRegions.toLowerCase());this.bindZoomButtons(),i.mapIndex++};i.prototype={transX:0,transY:0,scale:1,baseTransX:0,baseTransY:0,baseScale:1,width:0,height:0,countries:{},countriesColors:{},countriesData:{},zoomStep:1.4,zoomMaxStep:4,zoomCurStep:1,setColors:function(e,t){if(typeof e=="string")this.countries[e].setFill(t),this.countries[e].setAttribute("original",t);else{var n=e;for(var r in n)this.countries[r]&&(this.countries[r].setFill(n[r]),this.countries[r].setAttribute("original",n[r]))}},setValues:function(e){var t=0,n=Number.MAX_VALUE,r;for(var i in e)r=parseFloat(e[i]),r>t&&(t=e[i]),r&&r<n&&(n=r);this.colorScale.setMin(n),this.colorScale.setMax(t);var s={};for(i in e)r=parseFloat(e[i]),r?s[i]=this.colorScale.getColor(r):s[i]=this.color;this.setColors(s),this.values=e},setBackgroundColor:function(e){this.container.css("background-color",e)},setScaleColors:function(e){this.colorScale.setColors(e),this.values&&this.setValues(this.values)},setNormalizeFunction:function(e){this.colorScale.setNormalizeFunction(e),this.values&&this.setValues(this.values)},highlight:function(t,n){n=n||e("#"+this.getCountryId(t))[0],this.hoverOpacity?n.setOpacity(this.hoverOpacity):this.hoverColor&&(n.currentFillColor=n.getFill()+"",n.setFill(this.hoverColor))},unhighlight:function(t,n){n=n||e("#"+this.getCountryId(t))[0],n.setOpacity(1),n.currentFillColor&&n.setFill(n.currentFillColor)},select:function(t,n){n=n||e("#"+this.getCountryId(t))[0],this.selectedRegions.indexOf(t)<0&&(this.multiSelectRegion?this.selectedRegions.push(t):this.selectedRegions=[t],e(this.container).trigger("regionSelect.jqvmap",[t]),this.selectedColor&&(n.currentFillColor=this.selectedColor,n.setFill(this.selectedColor)))},deselect:function(t,n){n=n||e("#"+this.getCountryId(t))[0],this.selectedRegions.indexOf(t)>=0&&(this.selectedRegions.splice(this.selectedRegions.indexOf(t),1),e(this.container).trigger("regionDeselect.jqvmap",[t]),n.currentFillColor=n.getOriginalFill(),n.setFill(n.getOriginalFill()))},isSelected:function(e){return this.selectedRegions.indexOf(e)>=0},resize:function(){var e=this.baseScale;this.width/this.height>this.defaultWidth/this.defaultHeight?(this.baseScale=this.height/this.defaultHeight,this.baseTransX=Math.abs(this.width-this.defaultWidth*this.baseScale)/(2*this.baseScale)):(this.baseScale=this.width/this.defaultWidth,this.baseTransY=Math.abs(this.height-this.defaultHeight*this.baseScale)/(2*this.baseScale)),this.scale*=this.baseScale/e,this.transX*=this.baseScale/e,this.transY*=this.baseScale/e},reset:function(){this.countryTitle.reset();for(var e in this.countries)this.countries[e].setFill(i.defaultColor);this.scale=this.baseScale,this.transX=this.baseTransX,this.transY=this.baseTransY,this.applyTransform()},applyTransform:function(){var e,t,n,r;this.defaultWidth*this.scale<=this.width?(e=(this.width-this.defaultWidth*this.scale)/(2*this.scale),n=(this.width-this.defaultWidth*this.scale)/(2*this.scale)):(e=0,n=(this.width-this.defaultWidth*this.scale)/this.scale),this.defaultHeight*this.scale<=this.height?(t=(this.height-this.defaultHeight*this.scale)/(2*this.scale),r=(this.height-this.defaultHeight*this.scale)/(2*this.scale)):(t=0,r=(this.height-this.defaultHeight*this.scale)/this.scale),this.transY>t?this.transY=t:this.transY<r&&(this.transY=r),this.transX>e?this.transX=e:this.transX<n&&(this.transX=n),this.canvas.applyTransformParams(this.scale,this.transX,this.transY)},makeDraggable:function(){var e=!1,t,n,r=this;r.isMoving=!1,r.isMovingTimeout=!1,this.container.mousemove(function(i){if(e){var s=r.transX,o=r.transY;r.transX-=(t-i.pageX)/r.scale,r.transY-=(n-i.pageY)/r.scale,r.applyTransform(),t=i.pageX,n=i.pageY,r.isMoving=!0,r.isMovingTimeout&&clearTimeout(r.isMovingTimeout)}return!1}).mousedown(function(r){return e=!0,t=r.pageX,n=r.pageY,!1}).mouseup(function(){return e=!1,r.isMovingTimeout=setTimeout(function(){r.isMoving=!1},100),!1})},bindZoomButtons:function(){var e=this,t=(jQuery("#zoom").innerHeight()-12-30-6-7-6)/(this.zoomMaxStep-this.zoomCurStep);this.container.find(".jqvmap-zoomin").click(function(){if(e.zoomCurStep<e.zoomMaxStep){var n=e.transX,r=e.transY,i=e.scale;e.transX-=(e.width/e.scale-e.width/(e.scale*e.zoomStep))/2,e.transY-=(e.height/e.scale-e.height/(e.scale*e.zoomStep))/2,e.setScale(e.scale*e.zoomStep),e.zoomCurStep++,jQuery("#zoomSlider").css("top",parseInt(jQuery("#zoomSlider").css("top"),10)-t)}}),this.container.find(".jqvmap-zoomout").click(function(){if(e.zoomCurStep>1){var n=e.transX,r=e.transY,i=e.scale;e.transX+=(e.width/(e.scale/e.zoomStep)-e.width/e.scale)/2,e.transY+=(e.height/(e.scale/e.zoomStep)-e.height/e.scale)/2,e.setScale(e.scale/e.zoomStep),e.zoomCurStep--,jQuery("#zoomSlider").css("top",parseInt(jQuery("#zoomSlider").css("top"),10)+t)}})},setScale:function(e){this.scale=e,this.applyTransform()},getCountryId:function(e){return"jqvmap"+this.index+"_"+e}},i.xlink="http://www.w3.org/1999/xlink",i.mapIndex=1,i.maps={};var s=function(e,t,n,r){e&&this.setColors(e),t&&this.setNormalizeFunction(t),n&&this.setMin(n),n&&this.setMax(r)};s.prototype={colors:[],setMin:function(e){this.clearMinValue=e,typeof this.normalize=="function"?this.minValue=this.normalize(e):this.minValue=e},setMax:function(e){this.clearMaxValue=e,typeof this.normalize=="function"?this.maxValue=this.normalize(e):this.maxValue=e},setColors:function(e){for(var t=0;t<e.length;t++)e[t]=s.rgbToArray(e[t]);this.colors=e},setNormalizeFunction:function(e){e==="polynomial"?this.normalize=function(e){return Math.pow(e,.2)}:e==="linear"?delete this.normalize:this.normalize=e,this.setMin(this.clearMinValue),this.setMax(this.clearMaxValue)},getColor:function(e){typeof this.normalize=="function"&&(e=this.normalize(e));var t=[],n=0,r;for(var i=0;i<this.colors.length-1;i++)r=this.vectorLength(this.vectorSubtract(this.colors[i+1],this.colors[i])),t.push(r),n+=r;var s=(this.maxValue-this.minValue)/n;for(i=0;i<t.length;i++)t[i]*=s;i=0,e-=this.minValue;while(e-t[i]>=0)e-=t[i],i++;var o;i==this.colors.length-1?o=this.vectorToNum(this.colors[i]).toString(16):o=this.vectorToNum(this.vectorAdd(this.colors[i],this.vectorMult(this.vectorSubtract(this.colors[i+1],this.colors[i]),e/t[i]))).toString(16);while(o.length<6)o="0"+o;return"#"+o},vectorToNum:function(e){var t=0;for(var n=0;n<e.length;n++)t+=Math.round(e[n])*Math.pow(256,e.length-n-1);return t},vectorSubtract:function(e,t){var n=[];for(var r=0;r<e.length;r++)n[r]=e[r]-t[r];return n},vectorAdd:function(e,t){var n=[];for(var r=0;r<e.length;r++)n[r]=e[r]+t[r];return n},vectorMult:function(e,t){var n=[];for(var r=0;r<e.length;r++)n[r]=e[r]*t;return n},vectorLength:function(e){var t=0;for(var n=0;n<e.length;n++)t+=e[n]*e[n];return Math.sqrt(t)}},s.arrayToRgb=function(e){var t="#",n;for(var r=0;r<e.length;r++)n=e[r].toString(16),t+=n.length==1?"0"+n:n;return t},s.rgbToArray=function(e){return e=e.substr(1),[parseInt(e.substr(0,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(4,2),16)]}})(jQuery);