function setday(e,t,n,r,i){if(null==e)return null;(new Calendar(e,t,n,r,i)).show()}function setmonth(e,t,n,r,i){if(null==e)return null;(new Calendar(e,t,n,r,i,"m")).show()}function getFrameDocument(e){if(e.contentDocument)var t=e.contentDocument;else if(e.contentWindow)var t=e.contentWindow.document;return t}function checkDate(e,t,n){var r=["31","28","31","30","31","30","31","31","30","31","30","31"],i="";return e%4==0&&(r[1]="29"),n>r[t]?i=r[t]:i=n,i}function Calendar(e,t,n,r,i,s){this.beginDate="1900-01-01".toDate(),this.endDate="2020-01-01".toDate(),this.lang=0,this.type="d",this.dateFormatStyle="yyyy-MM-dd",null!=s&&(this.type=s,"m"==this.type&&(this.dateFormatStyle="yyyy-MM")),t!=null&&(this.dateFormatStyle=t),this.currentDate=new Date;var o=new Date;null!=e.value&&""!=e.value&&(o=e.value.toDate(this.dateFormatStyle)),null!=o?this.date=o:this.date=new Date,null!=n&&(this.beginDate=n),null!=r&&(this.endDate=r),i!=null&&(this.lang=i),this.dateControl=e,this.panel=document.getElementById("calendarPanel"),this.iframe=document.getElementById("calendarIframe"),this.isFocus=!1,this.draw()}function getElementsByClassName(e,t,n){var r=t=="*"&&e.all?e.all:e.getElementsByTagName(t),i=new Array;n=n.replace(/\-/g,"\\-");var s=new RegExp("(^|\\s)"+n+"(\\s|$)"),o;for(var u=0;u<r.length;u++)o=r[u],s.test(o.className)&&i.push(o);return i}Calendar.prototype.style=function(){var e="<style type='text/css'>";return e+=".calendar {font-size:12px; margin:0;padding:0px;border:1px solid #397EAE;background-color:#DBE7F2;}",e+=".calendar ul {list-style-type:none; margin:0; padding:0;vertical-align:middle;}",e+=".calendar li {float:left;}.calendar b{font-weight:bold;}",e+=".calendar .day li {height:20px;}",e+=".calendar .day li,.calendar .date li{float:left;width:14.13%;height:20px;line-height:20px;text-align:center;}",e+=".calendar .day li{font-weight:bold;} .calendar .date li{background-color:#EDF3F9;}",e+=".calendar .month li{float:left;width:24.8%;height:20px;line-height:20px;text-align:center;background-color:#EDF3F9;}",e+=".calendar li a{ text-decoration:none; font-family:Tahoma; font-size:11px; color:#333}",e+=".calendar li:hover {cursor:pointer;color:#f30; text-decoration:none;background-color:#EDF3F9;}",e+=".calendar .date li:hover, .calendar .month li:hover{cursor:pointer;color:#f30; text-decoration:none;background-color:#DBE7F2;}",e+=".calendarlihover {color:#f30;text-decoration:none;background-color:#E8F2FE;}",e+=".calendar li a.hasArticle {font-weight:bold; color:#f60 !important}",e+=".lastMonthDate, .nextMonthDate {color:#bbb;font-size:11px}",e+=".selectThisYear, .selectThisMonth{text-decoration:none; margin:0px; color:#000; font-weight:bold}",e+=".calendar .LastMonth, .calendar .NextMonth{text-decoration:none; color:#000; font-size:18px; font-weight:bold; line-height:16px;}",e+=".calendarTitle{background:#EDF3F9;text-align:center;height:20px;line-height:20px;clear:both;width:100%;}",e+=".calendarTitle .mark{text-decoration:none;color:#000;font-family:Tahoma;font-size:18px;font-weight:normal;}",e+=".today{ background-color:#ffffaa;border:1px solid #f60;padding:0 1px;}",e+=".today a { color:#f30; }",e+=".calendarBottom {text-align:center;height:20px;line-height:20px;clear:both;width:100%;border-top:1px solid #ddd;}",e+=".calendarBottom li{float:left;height:20px;line-height:20px;font-weight:bold;text-align:center;}",e+="</style>",e},String.prototype.toDate=function(e){null==e&&(e="yyyy-MM-dd");var t=e.replace("yyyy","(\\~1{4})").replace("yy","(\\~1{2})").replace("MM","(\\~1{2})").replace("M","(\\~1{1,2})").replace("dd","(\\~1{2})").replace("d","(\\~1{1,2})").replace(/~1/g,"d"),n;if((new RegExp(t)).test(this)){var r=e.indexOf("yyyy"),i=e.indexOf("MM"),s=e.indexOf("dd");i==-1&&(i=e.indexOf("M")),r==-1&&(r=e.indexOf("yy")),s==-1&&(s=e.indexOf("d"));var o=new Array(r+"y",i+"m",s+"d"),u={y:0,m:0,d:1},a=this.match(t);for(var f=1;f<a.length;f++){if(f==0)return;var l=o[f-1].split("")[1];u[l]=a[f]}u.y.toString().length==2&&(u.y=parseInt("20"+u.y)),u.m=u.m-1,n=new Date(u.y,u.m,u.d)}if(n==null||isNaN(n))n=new Date;return n},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"w+":"日一二三四五六".charAt(this.getDay()),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)(new RegExp("("+n+")")).test(e)&&(e=e.replace(RegExp.$1,RegExp.$1.length==1?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},Date.prototype.dateAdd=function(e,t){switch(e){case"y":return new Date(this.getFullYear()+t,this.getMonth(),this.getDate());case"m":return new Date(this.getFullYear(),this.getMonth()+t,checkDate(this.getFullYear(),this.getMonth()+t,this.getDate()));case"d":return new Date(this.getFullYear(),this.getMonth(),this.getDate()+t);case"w":return new Date(this.getFullYear(),this.getMonth(),7*t+this.getDate())}},Calendar.language={title:[["",""],["年","月"]],months:[["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]],weeks:[["S","M","T","W","T","F","S"],["日","一","二","三","四","五","六"]],weekday:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],clear:[["Clear"],["清空"]],today:[["Today","Current"],["今天","当月"]],close:[["Close"],["关闭"]]},Calendar.prototype.draw=function(){var e=this.date.format("yyyy-MM").toDate("yyyy-MM");e<this.beginDate&&(this.date=this.beginDate),e>this.endDate&&(this.date=this.endDate),this.year=this.date.getFullYear(),this.month=this.date.getMonth();var t='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />'+this.style()+'</head><body style="padding:0px;margin:0px;">',n=this.date.dateAdd("d",1-this.date.getDate()),r=n.dateAdd("d",-1),i=n.getDay();r=r.getDate();var s=n.dateAdd("m",1).dateAdd("d",-1),o=s.getDate(),u=s.getDay(),a="<div id='calendar' class='calendar' style='width:";"d"==this.type?a+="150":a+="120",a+="px;'>",a+="<div class='calendarTitle'><ul>",a+="<li id='PrevYear' class='mark' style='width:12%;' title='Previous Year'>&laquo;</li>";if("d"==this.type){a+="<li id='PrevMonth' class='mark' style='width:12%;' title='Previous Month'>&lsaquo;</li>",a+="<li style='width:30%;'><span id='selectThisYear' class='selectThisYear'>"+this.date.getFullYear()+"</span>"+Calendar.language.title[this.lang][0]+"</li>",0==this.lang?a+="<li style='width:20%;'><span id='selectThisMonth' class='selectThisMonth'>"+Calendar.language.months[this.lang][this.date.getMonth()]+"</span></li>":a+="<li style='width:20%;'><span id='selectThisMonth' class='selectThisMonth'>"+(this.date.getMonth()+1)+"</span>"+Calendar.language.title[this.lang][1]+"</li>",a+="<li id='NextMonth' class='mark' style='width:12%;' title='Next Month'>&rsaquo;</li>",a+="<li id='NextYear' class='mark' style='width:12%;' title='Next Year'>&raquo;</li></ul></div>",a+="<div class='calendarBody'>",a+="<ul class='day'>";for(var f=0;f<Calendar.language.weeks[this.lang].length;f++)a+="<li title='"+Calendar.language.weekday[f]+"'>"+Calendar.language.weeks[this.lang][f]+"</li>";a+="</ul><ul class='date' id='thisMonthDate'>";var l="";for(var f=0;f<i;f++)l="<li class='lastMonthDate'>"+r+"</li>"+l,r--;a+=l;for(f=1;f<=o;f++){var c=n.dateAdd("d",f-1);if(c<this.beginDate||c>this.endDate){a+="<li class='lastMonthDate'>"+f+"</li>";continue}a+="<li class='thisMonth' title='"+c.format("yyyy-MM-dd")+"'><a href='javascript:void(0);' ",c.format("yyyy-MM-dd")==this.date.format("yyyy-MM-dd")&&(a+="class='today' "),a+=">"+f+"</a></li>"}var h=1;for(f=u;f<6;f++)a+="<li class='nextMonthDate'>"+h+"</li>",h++;a+="</ul>",a+="</div>",a+="<div class='calendarBottom'><ul>",a+="<li id='emptyCalendar' style='width:27%;' title='Clear'>"+Calendar.language.clear[this.lang]+"</li>",a+="<li id='selectCurrent' style='width:45%;' title='Today'>"+Calendar.language.today[this.lang][0]+"</li>"}else{a+="<li style='width:74%;'><span id='selectThisYear' class='selectThisYear'>"+this.date.getFullYear()+"</span>"+Calendar.language.title[this.lang][0]+"</li>",a+="<li id='NextYear' class='mark' style='width:12%;' title='Next Year'>&raquo;</li></ul></div>",a+="<div class='calendarBody'>",a+="</ul><ul class='month' id='thisMonth'>";for(var f=1;f<=12;f++){var c=(this.year+"-"+(f>9?f:"0"+f)).toDate("yyyy-MM");if(c<this.beginDate||c>this.endDate){a+="<li class='lastMonthDate'>"+f+"</li>";continue}a+="<li class='thisMonth' title='"+this.year+"-"+(f>9?f:"0"+f)+"-01'><a href='javascript:void(0);'",this.year+"-"+(f>9?f:"0"+f)==this.date.format("yyyy-MM")&&(a+=" class='today' "),a+=">"+f+"</a></li>"}a+="</ul>",a+="</div>",a+="<div class='calendarBottom'><ul>",a+="<li id='emptyCalendar' style='width:27%;' title='Clear'>"+Calendar.language.clear[this.lang]+"</li>",a+="<li id='selectCurrent' style='width:45%;' title='Current Month'>"+Calendar.language.today[this.lang][1]+"</li>"}a+="<li id='closeCalendar' style='width:27%;' title='Close'>"+Calendar.language.close[this.lang]+"</li>",a+="</ul></div>",a+="</div>",a+="</body></html>";var p=getFrameDocument(this.iframe);p.writeln(t),p.writeln(a),p.close(),this.document=p,this.bingEvent()},Calendar.prototype.bingEvent=function(){var e=this;this.setAutoHeight(),this.panel.onmouseover=function(){e.isFocus=!0},this.panel.onmouseout=function(){e.isFocus=!1},this.dateControl.onblur=function(){e.isFocus||e.hide()},this.getElementById("selectCurrent").onclick=function(){e.date=new Date,e.valueSelected(e.date),e.hide()},this.getElementById("emptyCalendar").onclick=function(){e.dateControl.value="",e.hide()},this.getElementById("closeCalendar").onclick=function(){e.hide()},this.getElementById("PrevYear").onclick=function(){e.date=e.date.dateAdd("y",-1),e.draw()},this.getElementById("PrevMonth")&&(this.getElementById("PrevMonth").onclick=function(){e.date=e.date.dateAdd("m",-1),e.draw()},this.getElementById("NextMonth").onclick=function(){e.date=e.date.dateAdd("m",1),e.draw()}),this.getElementById("NextYear").onclick=function(){e.date=e.date.dateAdd("y",1),e.draw()},this.getElementById("selectThisYear").onclick=function(){e.selectThisYear()},"d"==this.type&&(this.getElementById("selectThisMonth").onclick=function(){e.selectThisMonth()});var t=getElementsByClassName(this.document,"li","thisMonth");for(var n=0;n<t.length;n++)t[n].onclick=function(){e.date=this.title.toDate(),e.valueSelected(e.date),e.hide()}},Calendar.prototype.selectThisYear=function(){var e=this,t=this.date.getFullYear(),n=this.beginDate.getFullYear(),r=this.endDate.getFullYear(),i=this.getElementById("selectThisYear"),s="<select style='font-size:10px;'>";for(var o=r;o>=n;o--)s+="<option value='"+o+"'>"+o+"</option>";s+="</select>",i.innerHTML=s;var u=i.childNodes(0);u.value=t,u.onchange=function(){e.date.setFullYear(u.value),e.draw()}},Calendar.prototype.selectThisMonth=function(){var e=this,t=this.date.getMonth()+1,n=this.date.getFullYear(),r=this.endDate.getFullYear(),i=12;n==r&&(i=this.endDate.getMonth+1);var s=this.getElementById("selectThisMonth"),o="<select style='font-size:10px;'>";for(var u=1;u<=i;u++)o+="<option value='"+u+"'>"+Calendar.language.months[this.lang][u-1]+"</option>";o+="</select>",s.innerHTML=o;var a=s.childNodes(0);a.value=t,a.onchange=function(){e.date.setMonth(a.value-1),e.draw()}},Calendar.prototype.valueSelected=function(e){this.dateControl.value=e.format(this.dateFormatStyle)},Calendar.prototype.setAutoHeight=function(){var e=this.document.body.scrollHeight,t=this.getElementById("calendar").style.width;t=parseInt(t.substr(0,t.length-1))+2+"px",this.iframe.style.height=e,this.panel.style.height=e,this.panel.style.width=t},Calendar.prototype.getElementById=function(id){if(typeof id!="string"||id=="")return null;if(null==this.document)return null;if(this.document.getElementById)return this.document.getElementById(id);if(this.document.all)return this.document.all(id);try{return eval(id)}catch(e){return null}},Calendar.prototype.getElementsByTagName=function(e){if(null==this.document)return null;if(this.document.getElementsByTagName)return this.document.getElementsByTagName(e);if(this.document.all)return this.document.all.tags(e)},Calendar.prototype.getAbsPoint=function(e){var t=e.offsetLeft,n=e.offsetTop;while(e=e.offsetParent)t+=e.offsetLeft,n+=e.offsetTop;return{x:t,y:n}},Calendar.prototype.show=function(){var e=this.getAbsPoint(this.dateControl);this.panel.style.left=e.x+"px",this.panel.style.top=e.y+this.dateControl.offsetHeight+"px",this.setDisplayStyle("select","hidden"),this.panel.style.visibility="visible"},Calendar.prototype.hide=function(){this.setDisplayStyle("select","visible"),this.panel.style.visibility="hidden",this.isFocus=!1},Calendar.prototype.setDisplayStyle=function(e,t){var n=this.getElementsByTagName(e);for(var r=0;r<n.length;r++){if(e.toLowerCase()=="select"&&(n[r].name=="calendarYear"||n[r].name=="calendarMonth"))continue;n[r].style.visibility=t}},document.write('<div id="calendarPanel" style="position:absolute;visibility:hidden;z-index:9999;background-color:#FFFFFF;font-size:12px;width:20px;">'),document.write("<iframe id='calendarIframe' scrolling='no' frameborder='0' width='100%' height='100%'></iframe></div>");